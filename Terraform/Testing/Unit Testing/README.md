# Terraform Unit Testing 

|   Authors        |  Created on   |  Version   | Last updated by | Last edited on |
| -----------------| --------------| -----------|---------------- | -------------- |
| Vidhi Yadav      | 31 March 2024   |     v1     | Vidhi Yadav     | 31 March 2024    |

***
## Table of Contents 
+ [Introduction](#Introduction)
+ [Key Components](#key-features)
+ [Guide to Installation](#Installing-OWASP-Dependency-Check)
+ [Best Practices](#best-practices)
+ [Contact Information](#contact-information)
+ [References](#references)

***
## Introduction

When running 'terraform apply', it's crucial to avoid any adverse impact on critical business applications. To mitigate this risk, we implement a unit testing strategy. Unit testing ensures that resources and configurations possess the accurate metadata by verifying attributes and settings. These tests are executed independently, without dependence on external resources or API calls, and they do not interact with live infrastructure or external services.

With the release of Terraform v1.7.0, a native testing framework was introduced, enabling users to thoroughly test their Terraform resources

<img width="1793" alt="Screenshot 2024-03-31 at 10 13 26 PM" src="https://github.com/CodeOps-Hub/Documentation/assets/156056349/58453375-722a-4048-8235-4f8e36eaaa3c">

*** 
## Key Features

**In addition to testing attributes in the Terraform plan, unit tests can validate:**

* The number of resources or attributes generated by for_each or count.

* Values generated by for expressions.

* Values generated by built-in functions.

* Dependencies between modules.

* Values associated with interpolated values.

* Expected variables or outputs marked as sensitive.

***
## How Unit Testing Functions

The Terraform test mocking framework is designed to simulate resources, providers, and modules. By default, it operates with the `command = apply` , generating resources or infrastructure. However, it offers flexibility by allowing users to override this behavior with `command = plan` . In this mode, it avoids connecting to the actual API and instead leverages a **community tool** to mimic the behavior of the cloud provider API. Overall, this tool serves to mitigate costs associated with resource creation and prevents potential slowdowns in real-time API interactions and environment related dependencies.

***
## Comparing Terraform Unit Testing Framework with Traditional Unit Testing

| Aspect                                   | Traditional Unit Testing                                   | Terraform Unit Testing                                        |
|------------------------------------------|-----------------------------------------------------------|---------------------------------------------------------------|
| **Language Support**                     | Uses any programming language capable of parsing Terraform files | Utilizes native Terraform testing framework                   |
| **Parsing Limitations**                  | Faces difficulties in parsing variable interpolation and list iteration within Terraform configurations | Directly parses Terraform plan representation for comprehensive testing |
| **Understanding Terraform Constructs**   | Lacks native support for Terraform-specific syntax and constructs | Understands Terraform-specific behaviors including variable interpolation and dynamic behaviors |
| **Approach**                             | Relies on external tools or custom solutions               | Utilizes built-in functionality provided by Terraform         |
| **Complexity**                           | May require additional setup and integration efforts        | Provides streamlined testing process with native support      |

*** 
## Essential Block Components

<img width="688" alt="Screenshot 2024-03-31 at 10 35 19 PM" src="https://github.com/CodeOps-Hub/Documentation/assets/156056349/bf56cfe1-a830-46d1-a1f2-f8b47b973085">



***
## Proof of Concept (POC):

 * It is highly recommended to gain hands-on experience through our detailed Proof of Concept (POC) guide for [Terraform Unit Testing](). This comprehensive document walks you through a practical demonstration, providing step-by-step instructions on how we can test our terraform components. The POC guide delves into essential concepts into identifying early issues through unit testing.


***
## Best Practices



***
## Contact Information

|Vidhi Yadav                     | vidhi.yadhav.snaatak@mygurukulam.co                                                                                      
|---------------------------------|------------------------------------------------------------|

***
## References

| Title                                      | URL                                           |
|--------------------------------------------|-----------------------------------------------|
| Terraform Official Doc           | [Link](https://developer.hashicorp.com/terraform/language/tests#expecting-failures)   |
| IaC Testing     | [Link](https://www.hashicorp.com/blog/testing-hashicorp-terraform) |




